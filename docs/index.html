<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <link
      rel="preload"
      href="woff/Lode-Regular.woff2"
      as="font"
      type="font/woff2"
      crossorigin
    />
    <link
      rel="preload"
      href="woff/Lode-Italic.woff2"
      as="font"
      type="font/woff2"
      crossorigin
    />
    <link
      rel="preload"
      href="woff/Lode-Bold.woff2"
      as="font"
      type="font/woff2"
      crossorigin
    />
    <link
      rel="preload"
      href="woff/Lode-BoldItalic.woff2"
      as="font"
      type="font/woff2"
      crossorigin
    />
    <link
      rel="preload"
      href="woff/LodeDark-Regular.woff2"
      as="font"
      type="font/woff2"
      crossorigin
    />
    <link
      rel="preload"
      href="woff/LodeDark-Italic.woff2"
      as="font"
      type="font/woff2"
      crossorigin
    />
    <link
      rel="preload"
      href="woff/LodeDark-Bold.woff2"
      as="font"
      type="font/woff2"
      crossorigin
    />
    <link
      rel="preload"
      href="woff/LodeDark-BoldItalic.woff2"
      as="font"
      type="font/woff2"
      crossorigin
    />
    <style>
      @font-face {
        font-family: 'Lode Web';
        font-display: block;
        font-weight: 400;
        font-stretch: normal;
        font-style: normal;
        src: url('woff/Lode-Regular.woff2') format('woff2');
      }

      @font-face {
        font-family: 'Lode Web';
        font-display: block;
        font-weight: 400;
        font-stretch: normal;
        font-style: italic;
        src: url('woff/Lode-Italic.woff2') format('woff2');
      }

      @font-face {
        font-family: 'Lode Web';
        font-display: block;
        font-weight: 700;
        font-stretch: normal;
        font-style: normal;
        src: url('woff/Lode-Bold.woff2') format('woff2');
      }

      @font-face {
        font-family: 'Lode Web';
        font-display: block;
        font-weight: 700;
        font-stretch: normal;
        font-style: italic;
        src: url('woff/Lode-BoldItalic.woff2') format('woff2');
      }

      @font-face {
        font-family: 'Lode Dark Web';
        font-display: block;
        font-weight: 400;
        font-stretch: normal;
        font-style: normal;
        src: url('woff/LodeDark-Regular.woff2') format('woff2');
      }

      @font-face {
        font-family: 'Lode Dark Web';
        font-display: block;
        font-weight: 400;
        font-stretch: normal;
        font-style: italic;
        src: url('woff/LodeDark-Italic.woff2') format('woff2');
      }

      @font-face {
        font-family: 'Lode Dark Web';
        font-display: block;
        font-weight: 700;
        font-stretch: normal;
        font-style: normal;
        src: url('woff/LodeDark-Bold.woff2') format('woff2');
      }

      @font-face {
        font-family: 'Lode Dark Web', monospace;
        font-display: block;
        font-weight: 700;
        font-stretch: normal;
        font-style: italic;
        src: url('woff/LodeDark-BoldItalic.woff2') format('woff2');
      }

      :root {
        --lite-font: 'Lode Web', monospace;
        --lite-primary: #222222;
        --lite-background: #e1dfda;
        --dark-font: 'Lode Dark Web', monospace;
        --dark-primary: #ffffff;
        --dark-background: #1e2025;
        --highlight: color(display-p3 0 1 0.65);
        --highlight-thin: color(display-p3 0 1 0.65 / 0.35);
        --lite-link: color(display-p3 0 0.3 0.8 / 1);
        --dark-link: color(display-p3 0.22 1 0 / 1);

        --lite-ckw: maroon;
        --dark-ckw: pink;

        --solarized-red: #dc322f;
        --solarized-orange: #cb4b16;
        --solarized-yellow: #b58900;
        --solarized-green: #859900;
        --solarized-cyan: #2aa198;
        --solarized-blue: #268bd2;
        --solarized-violet: #6c71c4;
        --solarized-magenta: #d33682;
        --solarized-neutral: #7f7f7f;
      }

      sr { color: var(--solarized-red); }
      so { color: var(--solarized-orange); }
      sy { color: var(--solarized-yellow); }
      sg { color: var(--solarized-green); }
      sc { color: var(--solarized-cyan); }
      sb { color: var(--solarized-blue); }
      sv { color: var(--solarized-violet); }
      sm { color: var(--solarized-magenta); }
      sn { color: var(--solarized-neutral); }

      .trans, .trans * {
        background-color: transparent;
        color: transparent;
      }

      :root,
      .theme {
        font-family: var(--font);
        color: var(--primary);
        background-color: var(--background);
      }

      * {
        font-size: max(16px, 2vmin);
        line-height: 1.55;
        text-size-adjust: none;
        -webkit-text-size-adjust: none;
        caret-color: var(--highlight);
        caret-shape: block;
        transition: color 200ms linear, background-color 200ms linear;
      }

      ::selection {
        background-color: var(--highlight-thin);
      }

      body {
        margin: 0;
      }

      body > div {
        padding: 0 2ch 0;
        margin: 25vh auto 50vh;
        max-width: 70ch;
      }

      a {
        text-decoration: none;
        color: var(--link);
      }
      a:hover,
      a:focus {
        text-decoration: underline;
      }

      p {
        max-width: 70ch;
      }

      pre {
        margin: 0;
      }

      h1 {
        font-size: 1.5rem;
        font-weight: normal;
        margin-bottom: 2rem;
      }

      h1,
      h2,
      h3 {
        position: relative;
      }

      h2 {
        margin: 3rem 0 1rem;
      }

      h3 {
        margin: 2rem 0 1rem;
      }

      h1::before,
      h2::before,
      h3::before {
        opacity: 0.5;
        font-weight: normal;
        content: '# ';
      }
      h2::before {
        content: '## ';
      }
      h3::before {
        content: '### ';
      }

      @media screen and (min-width: 100ch) {
        h1 {
          font-size: 2rem;
        }
        h1::before,
        h2::before,
        h3::before {
          position: absolute;
          right: calc(100% + 1ch);
        }
      }

      .nofeat {
        font-feature-settings:
          'kern' 0,
          'calt' 0;
      }

      pre {
        font-family: inherit;
        font-size: inherit;
        background-color: #88888811;
        padding: 1rem 2ch;
        box-sizing: border-box;
        width: fit-content;
        min-width: min(100vw - 2ch, 70ch);
        max-width: min(100vw - 2ch, 100%);
        overflow-x: scroll;
      }

      pre:focus {
        background-color: #88888822;
        outline: none;
      }

      .switch {
        background: var(--background);
        border-radius: 0.75rem;
        cursor: pointer;
        display: block;
        height: 1.5rem;
        margin: -0.25rem -0.5rem;
        outline: solid 1px var(--primary);
        position: relative;
        width: calc(3rch + 1rem);

        & > input {
          opacity: 0;
          pointer-events: none;
          position: absolute;
        }

        &::before {
          content: '1 0';
          left: 0.5rem;
          opacity: 0.5;
          position: absolute;
          line-height: 1.5rem;
        }

        &::after {
          background-color: var(--background);
          border-radius: 0.5rem;
          content: '';
          display: block;
          height: 1em;
          left: 0;
          margin: 0.25rem;
          outline: solid 1px var(--primary);
          position: absolute;
          top: 0;
          transition: left 0.25s ease-out;
          width: 1rem;
        }

        &:has(input:checked) {
          /* background: var(--highlight-thin); */

          &::after {
            left: calc(2rch);
          }
        }
      }

      section {
        position: relative;
      }

      .rightCB {
        position: absolute;
        right: 1rch;
        top: 0;
      }

      cr {
        color: red;
      }

      cg {
        color: gray;
      }

      ckw {
        color: var(--ckw);
      }


    </style>
    <script>
      {
        const defineSheet = document.currentScript.previousElementSibling
        const cssVars = [...defineSheet.sheet.cssRules]
          .filter(
            rule =>
              rule instanceof CSSStyleRule && rule.selectorText === ':root',
          )
          .flatMap(rule => [...rule.style])
          .filter(style => style.startsWith('--'))
        const liteRule = cssVars
          .filter(v => v.startsWith('--lite-'))
          .map(v => `--${v.slice(7)}: var(${v});`)
          .join('\n')
        const darkRule = cssVars
          .filter(v => v.startsWith('--dark-'))
          .map(v => `--${v.slice(7)}: var(${v});`)
          .join('\n')
        const themeSheet = document.createElement('style')
        themeSheet.textContent = `:root {${darkRule}}\n@media (prefers-color-scheme: light) { :root {${liteRule}} }`
        defineSheet.after(themeSheet)
        defineSheet.textContent += `\n:root.lite, .lite {${liteRule}}\n:root.dark, .dark {${darkRule}}`
        globalThis.toggleColor = liteOrDark => {
          themeSheet.textContent = `:root {${liteOrDark == 'dark' ? darkRule : liteRule}}`
        }
        const featureSheet = document.createElement('style')
        defineSheet.after(featureSheet)
        globalThis.setFeature = features => {
          featureSheet.textContent = `:root { font-feature-settings: ${features}; }`
        }
      }
    </script>
  </head>
  <body spellcheck="false">
    <div>
      <h1>Lode: a typeface for code</h1>

      <blockquote> This is a work in progress! If you're here, awesome. There will be bugs.</blockquote>

      <p>
        Lode is a monospace sans-serif typeface for reading and writing code in
        IDEs, text editors, and terminals. It is a modified variant of the
        excellent open-source typeface
        <a href="https://typeof.net/Iosevka/" target="_blank">Iosevka</a>. Lode
        is designed for clarity and efficiency at small sizes on high resolution
        screens featuring a very high x-height, thin strokes, slender column
        widths, open aperatures, and neo-grotesque forms with disambiguating
        characters.
      </p>

      <p>
        Lode includes support for dark mode, terminal fixed width, texture
        healing, powerline glyphs, and ligatures for common operators and
        markup.
      </p>

      <pre class="specimen nofeat" contenteditable>
 !"#$%&'()*+,-./  0123456789:;<=>?  <sn>U+0020-U+003F</sn>
 @ABCDEFGHIJKLMNO  PQRSTUVWXYZ[\]^_  <sn>U+0040-U+005F</sn>
 `abcdefghijkl&zwnj;mno  pqrstuvwxyz{|}~   <sn>U+0060-U+007F</sn>

 <b><sn># Bold</sn>
   !"#$%&'()*+,-./  0123456789:;<=>?  <sn>U+0020-U+003F</sn>
   @ABCDEFGHIJKLMNO  PQRSTUVWXYZ[\]^_  <sn>U+0040-U+005F</sn>
   `abcdefghijkl&zwnj;mno  pqrstuvwxyz{|}~   <sn>U+0060-U+007F</sn></b>

 <i><sn># Italic</sn>
   !"#$%&'()*+,-./  0123456789:;<=>?  <sn>U+0020-U+003F</sn>
   @ABCDEFGHIJKLMNO  PQRSTUVWXYZ[\]^_  <sn>U+0040-U+005F</sn>
   `abcdefghijkl&zwnj;mno  pqrstuvwxyz{|}~   <sn>U+0060-U+007F</sn></i>
</pre>

      <section>
        <h2>Slender columns</h2>

        <p>
          Lode sets a column width grid where 1ch = 0.55em, which is narrower
          than most common monospaced fonts which set 1ch = 0.6em without being
          a true condensed. This offers a balance of aiding legibility while
          keeping more columns on your screen.
        </p>
      </section>

      <section>
        <h2>Disambiguation</h2>

        <p>
          Lode aids accuracy and legibility by providing otherwise similar
          looking characters with unambiguous forms, differentiating tails, and
          a dotted zero.
        </p>

        <pre class="specimen nofeat" contenteditable>
!iIlL17|¦  0OQC8BßD¢co  CE3ƷʒЗзξ  uvwWMm
fΓſßoðdþb  G96bgpq¶P    $S5Z2zs   -_`'"«»&lt;&gt;</pre
        >
      </section>

      <section>
        <h2>Dark mode</h2>
        <label class="switch rightCB">
          <input type="checkbox" />
          <script>
            {
              const checkbox =
                document.currentScript.parentElement.firstElementChild
              checkbox.checked = !matchMedia('(prefers-color-scheme: light)')
                .matches
              checkbox.onchange = () =>
                toggleColor(checkbox.checked ? 'dark' : 'lite')
            }
          </script>
        </label>

        <p>
          When light text appears on a dark background, it can be perceived as
          being slightly bold. Lode has a variant "Lode Dark" with a slightly
          thinner stroke weight to compensate for this and increase clarity.
        </p>

        <div style="position: relative; width: fit-content">
          <pre
            contenteditable
            class="trans"
            style="position: relative; z-index: 2;"
          >
(<sr>defn</sr> <sb>lazy-loop</sb> [<sv>n</sv>]
  (<sb>lazy-seq</sb>
    (<sb>when</sb> (</sb>pos?</sb> <sv>n</sv>)
      (<sb>cons</sb> <sy>"When life gives you lambdas, make lazy loops."</sy>
            (<sb>lazy-loop</sb> (<sb>dec</sb> <sv>n</sv>))))))</pre
          >
          <div
            class="dark theme"
            style="
              pointer-events: none;
              position: absolute;
              top: 0;
              left: 0;
              right: 0;
              bottom: 0;
              margin: 0;
            "
          >
            <pre />
          </div>
          <div
            class="lite theme"
            style="
              clip-path: url(#lite-mask);
              pointer-events: none;
              position: absolute;
              top: 0;
              left: 0;
              right: 0;
              bottom: 0;
              margin: 0;
            "
          >
            <pre />
          </div>
          <svg
            width="0"
            height="0"
            viewBox="0 0 740 600"
            style="position: absolute"
          >
            <defs>
              <clipPath id="lite-mask">
                <rect
                  x="0"
                  y="0"
                  width="250"
                  height="600"
                  style="transition: none"
                />
              </clipPath>
            </defs>
          </svg>
          <script>
            {
              const parentDiv = document.currentScript.parentElement
              const [pre, litePre, darkPre] = parentDiv.querySelectorAll('pre')
              const [mask] = document.getElementById('lite-mask').children
              let animating = true
              let x = 0
              let prevTs, timeout, frame
              pre.addEventListener('mousemove', onMouseMove)
              pre.addEventListener('touchstart', onTouchStart)
              pre.addEventListener('input', updateText)
              updateText()
              schedule()
              // ----
              function schedule() {
                frame = requestAnimationFrame(step)
              }
              function step(ts) {
                const elapsed = ts - (prevTs ?? ts)
                prevTs = ts
                draw(x + elapsed / 20)
                frame = requestAnimationFrame(step)
              }
              function draw(nextX) {
                const width = litePre.offsetWidth
                x = nextX % (width * 2)
                mask.setAttribute('x', x - width)
                mask.setAttribute('width', width)
              }
              function setX(globalX) {
                const width = litePre.offsetWidth
                draw(
                  globalX -
                    parentDiv.getBoundingClientRect().x +
                    (x > width ? width : 0),
                )
                prevTs = null
                cancelAnimationFrame(frame)
                clearTimeout(timeout)
                timeout = setTimeout(schedule, 1000)
              }
              function updateText() {
                darkPre.replaceChildren(...pre.cloneNode(true).childNodes)
                litePre.replaceChildren(...pre.cloneNode(true).childNodes)
              }
              function onMouseMove(event) {
                setX(event.clientX)
              }
              function onTouchStart(event) {
                setX(event.touches[0].clientX)
                const onTouchMove = moveEvent =>
                  setX(moveEvent.touches[0].clientX)
                const onTouchEnd = () => {
                  removeEventListener('touchmove', onTouchMove)
                  removeEventListener('touchend', onTouchEnd)
                }
                addEventListener('touchmove', onTouchMove)
                addEventListener('touchend', onTouchEnd)
              }
            }
          </script>
        </div>
      </section>

      <section>
        <h2>Terminal fixed width</h2>

        <p>
          Terminals require fonts to render every character in exactly one
          column width. Lode contains many two-column width characters, but has
          a variant "Lode Term" with single-column variants.
        </p>
      </section>

      <section>
        <h2>Texture healing</h2>
        <label class="switch rightCB">
          <input type="checkbox" checked />
          <script>
            {
              const checkbox =
                document.currentScript.parentElement.firstElementChild
              checkbox.onchange = () =>
                setFeature(checkbox.checked ? '' : '"kern" 0, "calt" 0')
            }
          </script>
        </label>

        <p>
          Monospace fonts face a forced tradeoff: characters of typically very
          different widths must each fill the same space. Narrow characters like
          <ckw>i</ckw>, <ckw>j</ckw>, and <ckw>l</ckw> use serifs and hooks to
          visually fill the space, however wide characters like <ckw>w</ckw> and
          <ckw>m</ckw> must be compressed, reducing their clarity. This is most
          apparent when pairs of narrow and wide characters are next to each
          other.
        </p>
        <p>
          Texture healing replaces these pairs with more natural widths such
          that they still add up to full column widths, leading to more
          consistent visual density and improved clarity. Lode enables this by
          default under the
          <em>"kern"</em> font feature.
        </p>

        <pre contenteditable>
<sn>// Immutable programming for the www</sn>
<sr>let</sr> myNext = {...myPrev, <sv>width</sv>: minWidth }

<sn>// Min max window widths</sn>
window.<sb>onload</sb> <so>=</so> () <so>=></so> {
  <sr>const</sr> images <so>=</so> document.<sb>querySelectorAll</sb>(<sy>'img'</sy>);
  <sr>const</sr> minWidth <so>=</so> Math.<sb>min</sb>(...images.<sb>map</sb>(img <so>=></so> img.<sv>width</sv>))
  <sr>for</sr> (<sr>const</sr> image <sr>of</sr> images) {
    <sr>const</sr> aspectRatio <so>=</so> image.<sv>height</sv> <so>/</so> image.<sv>width</sv>
    image.<sv>width</sv> <so>=</so> minWidth
    image.<sv>height</sv> <so>=</so> minWidth <so>*</so> aspectRatio
  }
}

xmx imx xmi imi immi xix mix xim mim miim im im.
xmx &zwnj;i&zwnj;m&zwnj;x x&zwnj;m&zwnj;i&zwnj; &zwnj;i&zwnj;mi&zwnj; &zwnj;i&zwnj;m&zwnj;m&zwnj;i&zwnj; x&zwnj;i&zwnj;x &zwnj;m&zwnj;i&zwnj;x xi&zwnj;m&zwnj; &zwnj;m&zwnj;i&zwnj;m&zwnj; &zwnj;m&zwnj;i&zwnj;i&zwnj;m&zwnj; &zwnj;i&zwnj;m&zwnj; &zwnj;i&zwnj;m&zwnj;.
xwx jwx xwj jwj jwwj xjx wjx xjw wjw wjjw jw jw.
xwx &zwnj;j&zwnj;w&zwnj;x x&zwnj;w&zwnj;j&zwnj; &zwnj;j&zwnj;wj&zwnj; &zwnj;j&zwnj;w&zwnj;w&zwnj;j&zwnj; x&zwnj;j&zwnj;x &zwnj;w&zwnj;j&zwnj;x xj&zwnj;w&zwnj; &zwnj;w&zwnj;j&zwnj;w&zwnj; &zwnj;w&zwnj;j&zwnj;j&zwnj;w&zwnj; &zwnj;j&zwnj;w&zwnj; &zwnj;j&zwnj;w&zwnj;.
</pre
        >
      </section>
<!--
      <section>
        <h2>Powerline</h2>

        <p>
          Lode comes out of the box ready to support Powerline and other "nerd
          font" features.
        </p>
      </section> -->

      <section>
        <h2>Operator and markup ligatures</h2>

        <p>
          Lode is a typeface for code, and many common programming operators and
          text markup conventions have ligatures to improve their legibility
          without obscuring the original characters
        </p>

        <h3>Operators, comparators, and punctuation</h3>

        <p>Most common operators</p>

        <pre class="specimen" contenteditable>
&lt;html> &lt;/html> &lt;> &lt;/> &lt;!-- --&gt;
== != === !== <= >= += -= *= **= /= <<= >>= >>>= &= ^= |= ||= &&= ??=
x++ y-- z**n a&lt;&lt;n b>>n a>>>b a&&b a||b
(x, ...y) => [a, ...b]
{| |} [| |] <> /\ \/ _|_ -| |-
<- -> <-| >=> <~~> /-> -->--><--<
</pre
        >

        <h3>Literals and escape sequences</h3>

        <pre>
  3x4 0x0f31 0o755 0b0110011
</pre
        >

        <h3>Underlines</h3>

        <p>
          Many compilers and REPLs highlight errors with strings of "^". Lode
          replaces three or more as a continuous squiggly underline.
        </p>
        <p></p>

        <pre class="specimen">
Immutable data-sturctures
          <sy>^^^^^^^^^^^^^^^</sy> &lt;- did you mean "data-structures"?

for (const x of const y) {}
                <sr>^^^^^</sr>
                Unexpected token 'const'
    </pre>

        <h3>Waves, lines, and rules</h3>

        <p>
          Three or more of some characters produce continuous lines for use as
          rules or page boundaries.
        </p>

        <pre class="specimen">
~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
_ ____________________________
- ----------------------------
+ ++++++++++++++++++++++++++++
^ ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
# ############################
    </pre
        >
      </section>
    </div>
  </body>
</html>
